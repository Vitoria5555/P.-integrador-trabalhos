nome_arquivo_cliente = f"{nome_completo.replace(' ', '_')}_detalhes.csv"
        with open(nome_arquivo_cliente, 'w', newline='') as csvfile:
            fieldnames = ['nome', 'caso', 'despesa', 'receita']
            writer = csv.DictWriter(csvfile, fieldnames=fieldnames)
            writer.writeheader()
            writer.writerows(casos_encontrados)

            total_despesa = sum(row['despesa'] for row in casos_encontrados)
            total_receita = sum(row['receita'] for row in casos_encontrados)
            diferenca_total = total_receita - total_despesa

            writer.writerow({'nome': 'Total', 'caso': '', 'despesa': total_despesa, 'receita': total_receita})
            writer.writerow({'nome': 'Diferença', 'caso': '', 'despesa': '', 'receita': diferenca_total})

        print(f"Arquivo '{nome_arquivo_cliente}' gravado com sucesso.")
    else:
        print(f"Nenhum caso encontrado para o cliente {nome_completo.title()}.")

# Função principal
def main():
    dados = carregar_dados()
    while True:
        exibir_menu()
        opcao = input("Escolha uma opção: ").strip()
        if opcao == '1':
            buscar_casos_por_nome(dados)
        elif opcao == '2':
            buscar_detalhes_por_caso(dados)
        elif opcao == '3':
            estatisticas_gerais(dados)
        elif opcao == '4':
            gravar_detalhes_cliente(dados)
        elif opcao == '5':
            print("Saindo do programa.")
            break
        else:
            print("Opção inválida, por favor tente novamente.")

if __name__ == "__main__":
    main()

Resultado
1. Buscar casos por nome de cliente
2. Buscar detalhes por número de caso
3. Estatísticas gerais
4. Gravar detalhes de cliente em arquivo
5. Sair
Escolha uma opção: 
Opção inválida, por favor tente novamente.
Menu:
1. Buscar casos por nome de cliente
2. Buscar detalhes por número de caso
3. Estatísticas gerais
4. Gravar detalhes de cliente em arquivo
5. Sair
Escolha uma opção: 1
Digite o nome completo do cliente: AP2
Nenhum caso encontrado para o cliente Ap2.
Menu:
1. Buscar casos por nome de cliente
2. Buscar detalhes por número de caso
3. Estatísticas gerais
4. Gravar detalhes de cliente em arquivo
5. Sair
Escolha uma opção: ANA
Opção inválida, por favor tente novamente.
Menu:
1. Buscar casos por nome de cliente
2. Buscar detalhes por número de caso
3. Estatísticas gerais
4. Gravar detalhes de cliente em arquivo
5. Sair
Escolha uma opção: 2
Digite o número do caso: 0
Nenhum caso encontrado com o número 0.
Menu:
1. Buscar casos por nome de cliente
2. Buscar detalhes por número de caso
3. Estatísticas gerais
4. Gravar detalhes de cliente em arquivo
5. Sair
Escolha uma opção: 

